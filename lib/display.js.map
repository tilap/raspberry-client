{"version":3,"sources":["../src/display.js"],"names":[],"mappings":";;;;;QAMgB;QAIA;QAOA;QAoBA;;;;;;;;AAjChB,MAAM,SAAS,+BAAkB,aAAlB,EAAiC,sBAAS,IAAT,CAA1C;;;;EAEC,SAAS,OAAT,GAAmB;AACtB,WAAO,wBAAU,cAAV,EAA0B,CAAC,SAAD,CAA1B,CAAP,CADsB;CAAnB;;;;EAIA,SAAS,MAAT,GAAkB;AACrB,WAAO,wBAAU,cAAV,EAA0B,CAAC,MAAD,EAAS,qBAAT,CAA1B,CAAP,CADqB;CAAlB;;AAIP,IAAI,WAAJ;AACA,IAAI,YAAJ;;;;EAEO,SAAS,KAAT,GAAiB;AACpB,WAAO,IAAP,CAAY,eAAZ,EADoB;AAEpB,kBAAc,IAAd,CAFoB;AAGpB,mBAAe,oBAAM,cAAN,EAAsB,CAAC,OAAD,EAAU,qBAAV,CAAtB,CAAf,CAHoB;AAIpB,iBAAa,MAAb,CAAoB,EAApB,CAAuB,MAAvB,EAA+B,QAAQ;AACnC,eAAO,KAAP,CAAa,KAAK,QAAL,EAAb,EADmC;KAAR,CAA/B,CAJoB;;AAQpB,iBAAa,MAAb,CAAoB,EAApB,CAAuB,MAAvB,EAA+B,QAAQ;AACnC,eAAO,KAAP,CAAa,KAAK,QAAL,EAAb,EADmC;KAAR,CAA/B,CARoB;;AAYpB,iBAAa,EAAb,CAAgB,OAAhB,EAAyB,QAAQ;AAC7B,eAAO,KAAP,CAAa,CAAC,+BAAD,GAAkC,IAAlC,EAAuC,CAApD,EAD6B;AAE7B,YAAI,WAAJ,EAAiB;AACb,oBADa;SAAjB;KAFqB,CAAzB,CAZoB;CAAjB;;;;EAoBA,SAAS,IAAT,GAAgB;AACnB,WAAO,IAAP,CAAY,cAAZ,EADmB;AAEnB,kBAAc,KAAd,CAFmB;AAGnB,QAAI,YAAJ,EAAkB;AACd,qBAAa,IAAb,GADc;AAEd,uBAAe,IAAf,CAFc;KAAlB;CAHG","file":"display.js","sourcesContent":["import { ConsoleLogger, LogLevel } from 'nightingale';\nimport { getUrl } from './config';\nimport { runScript, spawn } from './scripts';\n\nconst logger = new ConsoleLogger('app.display', LogLevel.INFO);\n\nexport function refresh() {\n    return runScript('./browser.sh', ['refresh']);\n}\n\nexport function update() {\n    return runScript('./browser.sh', ['load', getUrl()]);\n}\n\nlet autoRestart;\nlet childProcess;\n\nexport function start() {\n    logger.info('start display');\n    autoRestart = true;\n    childProcess = spawn('./browser.sh', ['start', getUrl()]);\n    childProcess.stdout.on('data', data => {\n        logger.debug(data.toString());\n    });\n\n    childProcess.stderr.on('data', data => {\n        logger.error(data.toString());\n    });\n\n    childProcess.on('close', code => {\n        logger.error(`child process exited with code ${code}`);\n        if (autoRestart) {\n            start();\n        }\n    });\n}\n\nexport function stop() {\n    logger.info('stop display');\n    autoRestart = false;\n    if (childProcess) {\n        childProcess.kill();\n        childProcess = null;\n    }\n}\n"]}