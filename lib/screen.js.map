{"version":3,"sources":["../src/screen.js"],"names":[],"mappings":";;;;;;QAMgB;QAIA;;;;;;;;AANhB,MAAM,SAAS,+BAAkB,YAAlB,EAAgC,sBAAS,IAAT,CAAzC;;;;EAEC,SAAS,EAAT,GAAc;AACjB,WAAO,wBAAU,aAAV,EAAyB,CAAC,IAAD,CAAzB,CAAP,CADiB;CAAd;;;;EAIA,SAAS,GAAT,GAAe;AAClB,WAAO,wBAAU,aAAV,EAAyB,CAAC,KAAD,CAAzB,CAAP,CADkB;CAAf;;;;;;AAOP,SAAS,KAAT,GAAiB;AACb,WAAO,wBAAU,aAAV,EAAyB,CAAC,OAAD,CAAzB,CAAP,CADa;CAAjB;;;;;;AAOA,SAAS,SAAT,GAAqB;AACjB,WAAO,2BAAa,aAAb,EAA4B,CAAC,WAAD,CAA5B,CAAP,CADiB;CAArB;;AAIO,IAAI,kDAAqB,OAArB;AACX,YAAY,MAAM;AACd,UAAM,iBAAiB,OAAjB,CADQ;AAEd,QAAI,kBAAkB,kBAAlB,EAAsC;AACtC,eAAO,IAAP,CAAY,sBAAZ,EAAoC,EAAE,KAAK,kBAAL,EAAyB,KAAK,cAAL,EAA/D,EADsC;AAEtC,gBALG,qBAKH,qBAAqB,cAArB,CAFsC;AAGtC,mCAAW,EAAE,aAAa,cAAb,EAAb,EAHsC;KAA1C;CAFQ,EAOT,IAPH","file":"screen.js","sourcesContent":["import { ConsoleLogger, LogLevel } from 'nightingale';\nimport { runScript, listenScript } from './scripts';\nimport { sendUpdate } from './tcp-client';\n\nconst logger = new ConsoleLogger('app.screen', LogLevel.INFO);\n\nexport function on() {\n    return runScript('./screen.sh', ['on']);\n}\n\nexport function off() {\n    return runScript('./screen.sh', ['off']);\n}\n\n/**\n * @returns {string} on|off|unavailable\n */\nfunction state() {\n    return runScript('./screen.sh', ['state']);\n}\n\n/**\n * @returns {string} on|off\n */\nfunction subscribe() {\n    return listenScript('./screen.sh', ['subscribe']);\n}\n\nexport let currentScreenState = state();\nsetInterval(() => {\n    const newScreenState = state();\n    if (newScreenState != currentScreenState) {\n        logger.info('screen state changed', { old: currentScreenState, new: newScreenState })\n        currentScreenState = newScreenState;\n        sendUpdate({ screenState: newScreenState })\n    }\n}, 5000);\n"]}