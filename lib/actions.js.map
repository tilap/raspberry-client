{"version":3,"sources":["../src/actions.js"],"names":[],"mappings":";;;;;QAMgB;QAIA;QAIA;;;;;;;;AAVhB,MAAM,SAAS,+BAAkB,aAAlB,EAAiC,sBAAS,IAAT,CAA1C;;;;;EAEC,SAAS,MAAT,CAAgB,GAAhB,EAAqB;AACxB,4BAAU,WAAV,EAAuB,CAAC,QAAD,EAAW,GAAX,CAAvB,EADwB;CAArB;;;;EAIA,SAAS,OAAT,GAAmB;AACtB,4BAAU,WAAV,EAAuB,CAAC,SAAD,CAAvB,EADsB;CAAnB;;;;EAIA,SAAS,UAAT,GAAsB;AACzB,WAAO,IAAP,CAAY,aAAZ,EADyB;AAEzB,QAAI;AACA,sCAAU,KAAV,EAAiB,CAAC,MAAD,CAAjB,EAA2B,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,IAAb,CAAL,EAA/C,EADA;AAEA,sCAAU,KAAV,EAAiB,CAAC,SAAD,EAAY,cAAZ,CAAjB,EAA8C,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,IAAb,CAAL,EAAlE,EAFA;AAGA,sCAAU,KAAV,EAAiB,CAAC,OAAD,EAAU,cAAV,CAAjB,EAA4C,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,IAAb,CAAL,EAAhE,EAHA;AAIA,sCAAU,MAAV,EAAkB,CAAC,eAAD,EAAkB,SAAlB,EAA6B,uBAA7B,CAAlB,EAJA;KAAJ,CAKE,OAAO,GAAP,EAAY;AACV,eAAO,KAAP,CAAa,IAAI,OAAJ,CAAb,CADU;KAAZ;CAPC","file":"actions.js","sourcesContent":["import { spawnSync } from 'child_process';\nimport { ConsoleLogger, LogLevel } from 'nightingale';\nimport { runScript } from './scripts';\n\nconst logger = new ConsoleLogger('app.actions', LogLevel.INFO);\n\nexport function reload(url) {\n    runScript('screen.sh', ['reload', url]);\n}\n\nexport function refresh() {\n    runScript('screen.sh', ['refresh']);\n}\n\nexport function selfUpdate() {\n    logger.info('self update');\n    try {\n        spawnSync('git', ['pull'], { stdio: 'inherit', cwd: `${__dirname}/../` });\n        spawnSync('npm', ['install', '--production'], { stdio: 'inherit', cwd: `${__dirname}/../` });\n        spawnSync('npm', ['prune', '--production'], { stdio: 'inherit', cwd: `${__dirname}/../` });\n        spawnSync('sudo', ['supervisorctl', 'restart', 'node-raspberry-client']);\n    } catch (err) {\n        logger.error(err.message);\n    }\n}\n"]}