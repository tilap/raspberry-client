{"version":3,"sources":["../src/actions.js"],"names":[],"mappings":";;;;;QAcgB;QAIA;QAIA;;;;;;AAnBhB,MAAM,SAAS,+BAAkB,SAAlB,CAAT;;;;;;EAEN,SAAS,SAAT,CAAmB,MAAnB,EAA2B,IAA3B,EAAiC;AAC7B,WAAO,IAAP,CAAY,YAAZ,EAA0B,EAAE,MAAF,EAAU,IAAV,EAA1B,EAD6B;AAE7B,QAAI;AACA,sCAAU,MAAV,EAAkB,IAAlB,EAAwB,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,YAAb,CAAL,EAA5C,EADA;KAAJ,CAEE,OAAO,GAAP,EAAY;AACV,eAAO,KAAP,CAAa,IAAI,OAAJ,CAAb,CADU;KAAZ;CAJN;;;;;EASO,SAAS,MAAT,CAAgB,GAAhB,EAAqB;AACxB,cAAU,WAAV,EAAuB,CAAC,QAAD,EAAW,GAAX,CAAvB,EADwB;CAArB;;;;EAIA,SAAS,OAAT,GAAmB;AACtB,cAAU,WAAV,EAAuB,CAAC,SAAD,CAAvB,EADsB;CAAnB;;;;EAIA,SAAS,UAAT,GAAsB;AACzB,WAAO,IAAP,CAAY,aAAZ,EADyB;AAEzB,QAAI;AACA,sCAAU,KAAV,EAAiB,CAAC,MAAD,CAAjB,EAA2B,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,IAAb,CAAL,EAA/C,EADA;AAEA,sCAAU,KAAV,EAAiB,CAAC,SAAD,EAAY,cAAZ,CAAjB,EAA8C,EAAE,OAAO,SAAP,EAAkB,KAAK,CAAC,GAAE,SAAH,EAAa,IAAb,CAAL,EAAlE,EAFA;AAGA,sCAAU,MAAV,EAAkB,CAAC,eAAD,EAAkB,SAAlB,EAA6B,uBAA7B,CAAlB,EAHA;KAAJ,CAIE,OAAO,GAAP,EAAY;AACV,eAAO,KAAP,CAAa,IAAI,OAAJ,CAAb,CADU;KAAZ;CANC","file":"actions.js","sourcesContent":["import { spawnSync } from 'child_process';\nimport { ConsoleLogger } from 'nightingale';\n\nconst logger = new ConsoleLogger('actions');\n\nfunction runScript(script, args) {\n    logger.info('run script', { script, args });\n    try {\n        spawnSync(script, args, { stdio: 'inherit', cwd: `${__dirname}/../scripts/` });\n    } catch (err) {\n        logger.error(err.message);\n    }\n}\n\nexport function reload(url) {\n    runScript('screen.sh', ['reload', url]);\n}\n\nexport function refresh() {\n    runScript('screen.sh', ['refresh']);\n}\n\nexport function selfUpdate() {\n    logger.info('self update');\n    try {\n        spawnSync('git', ['pull'], { stdio: 'inherit', cwd: `${__dirname}/../` });\n        spawnSync('npm', ['install', '--production'], { stdio: 'inherit', cwd: `${__dirname}/../` });\n        spawnSync('sudo', ['supervisorctl', 'restart', 'node-raspberry-client']);\n    } catch (err) {\n        logger.error(err.message);\n    }\n}\n"]}